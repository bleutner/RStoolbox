<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Spectral Indices — spectralIndices • RStoolbox</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spectral Indices — spectralIndices"><meta name="description" content="Calculate a suite of multispectral indices such as NDVI, SAVI etc. in an efficient way via C++."><meta property="og:description" content="Calculate a suite of multispectral indices such as NDVI, SAVI etc. in an efficient way via C++."><meta property="og:image" content="https://bleutner.github.io/RStoolbox/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RStoolbox</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="http://www.github.com/bleutner"><span class="fa fa-github fa-lg fab"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Spectral Indices</h1>
      <small class="dont-index">Source: <a href="https://github.com/bleutner/RStoolbox/blob/master/R/spectralIndices.R" class="external-link"><code>R/spectralIndices.R</code></a></small>
      <div class="d-none name"><code>spectralIndices.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate a suite of multispectral indices such as NDVI, SAVI etc. in an efficient way via C++.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spectralIndices</span><span class="op">(</span></span>
<span>  <span class="va">img</span>,</span>
<span>  blue <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  green <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  red <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  redEdge1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  redEdge2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  redEdge3 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  swir1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  swir2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  swir3 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scaleFactor <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  skipRefCheck <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  indices <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  index <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maskLayer <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maskValue <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  coefs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>L <span class="op">=</span> <span class="fl">0.5</span>, G <span class="op">=</span> <span class="fl">2.5</span>, L_evi <span class="op">=</span> <span class="fl">1</span>, C1 <span class="op">=</span> <span class="fl">6</span>, C2 <span class="op">=</span> <span class="fl">7.5</span>, s <span class="op">=</span> <span class="fl">1</span>, swir2ccc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    swir2coc <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-img">img<a class="anchor" aria-label="anchor" href="#arg-img"></a></dt>
<dd><p>SpatRaster. Typically remote sensing imagery, which is to be classified.</p></dd>


<dt id="arg-blue">blue<a class="anchor" aria-label="anchor" href="#arg-blue"></a></dt>
<dd><p>Character or integer. Blue band.</p></dd>


<dt id="arg-green">green<a class="anchor" aria-label="anchor" href="#arg-green"></a></dt>
<dd><p>Character or integer. Green band.</p></dd>


<dt id="arg-red">red<a class="anchor" aria-label="anchor" href="#arg-red"></a></dt>
<dd><p>Character or integer. Red band.</p></dd>


<dt id="arg-nir">nir<a class="anchor" aria-label="anchor" href="#arg-nir"></a></dt>
<dd><p>Character or integer. Near-infrared band (700-1100nm).</p></dd>


<dt id="arg-rededge-">redEdge1<a class="anchor" aria-label="anchor" href="#arg-rededge-"></a></dt>
<dd><p>Character or integer. Red-edge band (705nm)</p></dd>


<dt id="arg-rededge-">redEdge2<a class="anchor" aria-label="anchor" href="#arg-rededge-"></a></dt>
<dd><p>Character or integer. Red-edge band (740nm)</p></dd>


<dt id="arg-rededge-">redEdge3<a class="anchor" aria-label="anchor" href="#arg-rededge-"></a></dt>
<dd><p>Character or integer. Red-edge band (783nm)</p></dd>


<dt id="arg-swir-">swir1<a class="anchor" aria-label="anchor" href="#arg-swir-"></a></dt>
<dd><p>not used</p></dd>


<dt id="arg-swir-">swir2<a class="anchor" aria-label="anchor" href="#arg-swir-"></a></dt>
<dd><p>Character or integer. Short-wave-infrared band (1400-1800nm).</p></dd>


<dt id="arg-swir-">swir3<a class="anchor" aria-label="anchor" href="#arg-swir-"></a></dt>
<dd><p>Character or integer. Short-wave-infrared band (2000-2500nm).</p></dd>


<dt id="arg-scalefactor">scaleFactor<a class="anchor" aria-label="anchor" href="#arg-scalefactor"></a></dt>
<dd><p>Numeric. Scale factor for the conversion of scaled reflectances to [0,1] value range (applied as reflectance/scaleFactor) Neccesary for calculating EVI/EVI2 with scaled reflectance values.</p></dd>


<dt id="arg-skiprefcheck">skipRefCheck<a class="anchor" aria-label="anchor" href="#arg-skiprefcheck"></a></dt>
<dd><p>Logical. When EVI/EVI2 is to be calculated there is a rough heuristic check, whether the data are inside [0,1]+/-0.5 (after applying a potential <code>scaleFactor</code>).
If there are invalid reflectances, e.g. clouds with reflectance &gt; 1 this check will result in a false positive and skip EVI calculation. Use this argument to skip this check in such cases *iff* you are sure the data and scaleFactor are valid.</p></dd>


<dt id="arg-indices">indices<a class="anchor" aria-label="anchor" href="#arg-indices"></a></dt>
<dd><p>Character. One or more spectral indices to calculate (see Details). By default (NULL) all implemented indices given the spectral bands which are provided will be calculated.</p></dd>


<dt id="arg-index">index<a class="anchor" aria-label="anchor" href="#arg-index"></a></dt>
<dd><p>Character. Alias for <code>indices</code>.</p></dd>


<dt id="arg-masklayer">maskLayer<a class="anchor" aria-label="anchor" href="#arg-masklayer"></a></dt>
<dd><p>RasterLayer or SpatRaster containing a mask, e.g. clouds, for which pixels are set to NA. Alternatively a layername or -number can be provided if the mask is part of <code>img</code>.</p></dd>


<dt id="arg-maskvalue">maskValue<a class="anchor" aria-label="anchor" href="#arg-maskvalue"></a></dt>
<dd><p>Integer. Pixel value in <code>maskLayer</code> which should be masked in output, i.e. will be set to <code>NA</code> in all calculated indices.</p></dd>


<dt id="arg-coefs">coefs<a class="anchor" aria-label="anchor" href="#arg-coefs"></a></dt>
<dd><p>List of coefficients (see Details).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments such as filename etc. passed to <a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">writeRaster</a></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>SpatRaster</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>spectralIndices</code> calculates all indices in one go in C++,  which is more efficient than calculating each index separately (for large rasters).
By default all indices which can be calculated given the specified indices will be calculated. If you don't want all indices, use the <code>indices</code> argument to specify exactly which indices are to be calculated.
See the table bellow for index names and required bands.</p>
<p>Index values outside the valid value ranges (if such a range exists) will be set to NA. For example a pixel with NDVI &gt; 1 will be set to NA.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate NDVI</span></span></span>
<span class="r-in"><span><span class="va">ndvi</span> <span class="op">&lt;-</span> <span class="fu">spectralIndices</span><span class="op">(</span><span class="va">lsat</span>, red <span class="op">=</span> <span class="st">"B3_dn"</span>, nir <span class="op">=</span> <span class="st">"B4_dn"</span>, indices <span class="op">=</span> <span class="st">"NDVI"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ndvi</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class       : SpatRaster </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dimensions  : 310, 287, 1  (nrow, ncol, nlyr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> resolution  : 30, 30  (x, y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extent      : 619395, 628005, -419505, -410205  (xmin, xmax, ymin, ymax)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> coord. ref. : +proj=utm +zone=22 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> source(s)   : memory</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> name        :       NDVI </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> min value   : -0.5789474 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> max value   :  0.7629630 </span>
<span class="r-in"><span><span class="fu"><a href="ggR.html">ggR</a></span><span class="op">(</span><span class="va">ndvi</span>, geom_raster <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"white"</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="spectralIndices-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{ </span></span></span>
<span class="r-in"><span><span class="co">## Calculate all possible indices, given the provided bands </span></span></span>
<span class="r-in"><span><span class="co">## Convert DNs to reflectance (required to calculate EVI and EVI2)</span></span></span>
<span class="r-in"><span><span class="va">mtlFile</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external/landsat/LT52240631988227CUB02_MTL.txt"</span>, package<span class="op">=</span><span class="st">"RStoolbox"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lsat_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="radCor.html">radCor</a></span><span class="op">(</span><span class="va">lsat</span>, <span class="va">mtlFile</span>, method <span class="op">=</span> <span class="st">"apref"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 09:47:03 | Bands to convert to reflectance: B1_dn, B2_dn, B3_dn, B4_dn, B5_dn, B7_dn</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 09:47:03 | Thermal bands to convert to brightness temperature: B6_dn</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 09:47:03 | Processing thermal band(s)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 09:47:03 | Processing radiance / reflectance</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">SI</span> <span class="op">&lt;-</span> <span class="fu">spectralIndices</span><span class="op">(</span><span class="va">lsat_ref</span>, red <span class="op">=</span> <span class="st">"B3_tre"</span>, nir <span class="op">=</span> <span class="st">"B4_tre"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">SI</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spectralIndices-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Custom Spectral Index Calculation (beta) (supports only bands right now...)</span></span></span>
<span class="r-in"><span><span class="co"># Get all indices</span></span></span>
<span class="r-in"><span><span class="va">idxdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"RStoolbox.idxdb"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Customize the RStoolbox index-database and overwrite the option</span></span></span>
<span class="r-in"><span><span class="va">cdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">idxdb</span>, CUSTOM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mueller2024"</span>, <span class="st">"Super custom index"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="kw">function</span><span class="op">(</span><span class="va">blue</span>, <span class="va">red</span><span class="op">)</span> <span class="op">{</span><span class="va">blue</span> <span class="op">+</span> <span class="va">red</span><span class="op">}</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="rsOpts.html">rsOpts</a></span><span class="op">(</span>idxdb <span class="op">=</span> <span class="va">cdb</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the custom index, (also together with the provided ones)</span></span></span>
<span class="r-in"><span><span class="va">custom_ind</span> <span class="op">&lt;-</span> <span class="fu">spectralIndices</span><span class="op">(</span><span class="va">lsat</span>, blue <span class="op">=</span> <span class="fl">1</span>, red <span class="op">=</span> <span class="fl">3</span>, nir <span class="op">=</span> <span class="fl">4</span>, indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NDVI"</span>, <span class="st">"CUSTOM"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benjamin Leutner, Ned Horning, Jakob Schwalb-Willmann, Konstantin Mueller.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

