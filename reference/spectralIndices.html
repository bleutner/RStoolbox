<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Spectral Indices — spectralIndices • RStoolbox</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spectral Indices — spectralIndices"><meta name="description" content="Calculate a suite of multispectral indices such as NDVI, SAVI etc. in an efficient way via C++."><meta property="og:description" content="Calculate a suite of multispectral indices such as NDVI, SAVI etc. in an efficient way via C++."><meta property="og:image" content="https://bleutner.github.io/RStoolbox/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RStoolbox</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="http://www.github.com/bleutner"><span class="fa fa-github fa-lg fab"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Spectral Indices</h1>
      <small class="dont-index">Source: <a href="https://github.com/bleutner/RStoolbox/blob/master/R/spectralIndices.R" class="external-link"><code>R/spectralIndices.R</code></a></small>
      <div class="d-none name"><code>spectralIndices.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate a suite of multispectral indices such as NDVI, SAVI etc. in an efficient way via C++.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spectralIndices</span><span class="op">(</span></span>
<span>  <span class="va">img</span>,</span>
<span>  blue <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  green <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  red <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  redEdge1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  redEdge2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  redEdge3 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  swir1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  swir2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  swir3 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scaleFactor <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  skipRefCheck <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  indices <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  index <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maskLayer <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maskValue <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  coefs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>L <span class="op">=</span> <span class="fl">0.5</span>, G <span class="op">=</span> <span class="fl">2.5</span>, L_evi <span class="op">=</span> <span class="fl">1</span>, C1 <span class="op">=</span> <span class="fl">6</span>, C2 <span class="op">=</span> <span class="fl">7.5</span>, s <span class="op">=</span> <span class="fl">1</span>, swir2ccc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    swir2coc <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-img">img<a class="anchor" aria-label="anchor" href="#arg-img"></a></dt>
<dd><p>SpatRaster. Typically remote sensing imagery, which is to be classified.</p></dd>


<dt id="arg-blue">blue<a class="anchor" aria-label="anchor" href="#arg-blue"></a></dt>
<dd><p>Character or integer. Blue band.</p></dd>


<dt id="arg-green">green<a class="anchor" aria-label="anchor" href="#arg-green"></a></dt>
<dd><p>Character or integer. Green band.</p></dd>


<dt id="arg-red">red<a class="anchor" aria-label="anchor" href="#arg-red"></a></dt>
<dd><p>Character or integer. Red band.</p></dd>


<dt id="arg-nir">nir<a class="anchor" aria-label="anchor" href="#arg-nir"></a></dt>
<dd><p>Character or integer. Near-infrared band (700-1100nm).</p></dd>


<dt id="arg-rededge-">redEdge1<a class="anchor" aria-label="anchor" href="#arg-rededge-"></a></dt>
<dd><p>Character or integer. Red-edge band (705nm)</p></dd>


<dt id="arg-rededge-">redEdge2<a class="anchor" aria-label="anchor" href="#arg-rededge-"></a></dt>
<dd><p>Character or integer. Red-edge band (740nm)</p></dd>


<dt id="arg-rededge-">redEdge3<a class="anchor" aria-label="anchor" href="#arg-rededge-"></a></dt>
<dd><p>Character or integer. Red-edge band (783nm)</p></dd>


<dt id="arg-swir-">swir1<a class="anchor" aria-label="anchor" href="#arg-swir-"></a></dt>
<dd><p>not used</p></dd>


<dt id="arg-swir-">swir2<a class="anchor" aria-label="anchor" href="#arg-swir-"></a></dt>
<dd><p>Character or integer. Short-wave-infrared band (1400-1800nm).</p></dd>


<dt id="arg-swir-">swir3<a class="anchor" aria-label="anchor" href="#arg-swir-"></a></dt>
<dd><p>Character or integer. Short-wave-infrared band (2000-2500nm).</p></dd>


<dt id="arg-scalefactor">scaleFactor<a class="anchor" aria-label="anchor" href="#arg-scalefactor"></a></dt>
<dd><p>Numeric. Scale factor for the conversion of scaled reflectances to [0,1] value range (applied as reflectance/scaleFactor) Neccesary for calculating EVI/EVI2 with scaled reflectance values.</p></dd>


<dt id="arg-skiprefcheck">skipRefCheck<a class="anchor" aria-label="anchor" href="#arg-skiprefcheck"></a></dt>
<dd><p>Logical. When EVI/EVI2 is to be calculated there is a rough heuristic check, whether the data are inside [0,1]+/-0.5 (after applying a potential <code>scaleFactor</code>).
If there are invalid reflectances, e.g. clouds with reflectance &gt; 1 this check will result in a false positive and skip EVI calculation. Use this argument to skip this check in such cases *iff* you are sure the data and scaleFactor are valid.</p></dd>


<dt id="arg-indices">indices<a class="anchor" aria-label="anchor" href="#arg-indices"></a></dt>
<dd><p>Character. One or more spectral indices to calculate (see Details). By default (NULL) all implemented indices given the spectral bands which are provided will be calculated.</p></dd>


<dt id="arg-index">index<a class="anchor" aria-label="anchor" href="#arg-index"></a></dt>
<dd><p>Character. Alias for <code>indices</code>.</p></dd>


<dt id="arg-masklayer">maskLayer<a class="anchor" aria-label="anchor" href="#arg-masklayer"></a></dt>
<dd><p>RasterLayer or SpatRaster containing a mask, e.g. clouds, for which pixels are set to NA. Alternatively a layername or -number can be provided if the mask is part of <code>img</code>.</p></dd>


<dt id="arg-maskvalue">maskValue<a class="anchor" aria-label="anchor" href="#arg-maskvalue"></a></dt>
<dd><p>Integer. Pixel value in <code>maskLayer</code> which should be masked in output, i.e. will be set to <code>NA</code> in all calculated indices.</p></dd>


<dt id="arg-coefs">coefs<a class="anchor" aria-label="anchor" href="#arg-coefs"></a></dt>
<dd><p>List of coefficients (see Details).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments such as filename etc. passed to <a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">writeRaster</a></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>SpatRaster</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>spectralIndices</code> calculates all indices in one go in C++,  which is more efficient than calculating each index separately (for large rasters).
By default all indices which can be calculated given the specified indices will be calculated. If you don't want all indices, use the <code>indices</code> argument to specify exactly which indices are to be calculated.
See the table bellow for index names and required bands.</p>
<p>Index values outside the valid value ranges (if such a range exists) will be set to NA. For example a pixel with NDVI &gt; 1 will be set to NA.</p>






<table class="table table"><tr><td><strong> Index </strong></td><td><strong> Description </strong></td><td><strong> Source </strong></td><td><strong> Bands </strong></td><td><strong> Formula </strong></td></tr><tr><td>CLG</td><td>Green-band Chlorophyll Index</td><td>Gitelson2003</td><td><code>redEdge3, green</code></td><td>\(redEdge3/green - 1\)</td></tr><tr><td>CLRE</td><td>Red-edge-band Chlorophyll Index</td><td>Gitelson2003</td><td><code>redEdge3, redEdge1</code></td><td>\(redEdge3/redEdge1 - 1\)</td></tr><tr><td>CTVI</td><td>Corrected Transformed Vegetation Index</td><td>Perry1984</td><td><code>red, nir</code></td><td>\((NDVI + 0.5)/sqrt(abs(NDVI + 0.5))\)</td></tr><tr><td>DVI</td><td>Difference Vegetation Index</td><td>Richardson1977</td><td><code>red, nir</code></td><td>\(s * nir - red\)</td></tr><tr><td>EVI</td><td>Enhanced Vegetation Index</td><td>Huete1999</td><td><code>red, nir, blue</code></td><td>\(G * ((nir - red)/(nir + C1 * red - C2 * blue + L_evi))\)</td></tr><tr><td>EVI2</td><td>Two-band Enhanced Vegetation Index</td><td>Jiang 2008</td><td><code>red, nir</code></td><td>\(G * (nir - red)/(nir + 2.4 * red + 1)\)</td></tr><tr><td>GEMI</td><td>Global Environmental Monitoring Index</td><td>Pinty1992</td><td><code>red, nir</code></td><td>\((((nir^2 - red^2) * 2 + (nir * 1.5) + (red * 0.5))/(nir + red + 0.5)) * (1 - ((((nir^2 - red^2) * 2 + (nir * 1.5) + (red * 0.5))/(nir + red + 0.5)) * 0.25)) - ((red - 0.125)/(1 - red))\)</td></tr><tr><td>GNDVI</td><td>Green Normalised Difference Vegetation Index</td><td>Gitelson1998</td><td><code>green, nir</code></td><td>\((nir - green)/(nir + green)\)</td></tr><tr><td>KNDVI</td><td>Kernel Normalised Difference Vegetation Index</td><td>Camps-Valls2021</td><td><code>red, nir</code></td><td>\(tanh(((nir - red)/(nir + red)))^2\)</td></tr><tr><td>MCARI</td><td>Modified Chlorophyll Absorption Ratio Index</td><td>Daughtery2000</td><td><code>green, red, redEdge1</code></td><td>\(((redEdge1 - red) - (redEdge1 - green)) * (redEdge1/red)\)</td></tr><tr><td>MNDWI</td><td>Modified Normalised Difference Water Index</td><td>Xu2006</td><td><code>green, swir2</code></td><td>\((green - swir2)/(green + swir2)\)</td></tr><tr><td>MSAVI</td><td>Modified Soil Adjusted Vegetation Index</td><td>Qi1994</td><td><code>red, nir</code></td><td>\(nir + 0.5 - (0.5 * sqrt((2 * nir + 1)^2 - 8 * (nir - (2 * red))))\)</td></tr><tr><td>MSAVI2</td><td>Modified Soil Adjusted Vegetation Index 2</td><td>Qi1994</td><td><code>red, nir</code></td><td>\((2 * (nir + 1) - sqrt((2 * nir + 1)^2 - 8 * (nir - red)))/2\)</td></tr><tr><td>MTCI</td><td>MERIS Terrestrial Chlorophyll Index</td><td>DashAndCurran2004</td><td><code>red, redEdge1, redEdge2</code></td><td>\((redEdge2 - redEdge1)/(redEdge1 - red)\)</td></tr><tr><td>NBRI</td><td>Normalised Burn Ratio Index</td><td>Garcia1991</td><td><code>nir, swir3</code></td><td>\((nir - swir3)/(nir + swir3)\)</td></tr><tr><td>NDREI1</td><td>Normalised Difference Red Edge Index 1</td><td>GitelsonAndMerzlyak1994</td><td><code>redEdge2, redEdge1</code></td><td>\((redEdge2 - redEdge1)/(redEdge2 + redEdge1)\)</td></tr><tr><td>NDREI2</td><td>Normalised Difference Red Edge Index 2</td><td>Barnes2000</td><td><code>redEdge3, redEdge1</code></td><td>\((redEdge3 - redEdge1)/(redEdge3 + redEdge1)\)</td></tr><tr><td>NDVI</td><td>Normalised Difference Vegetation Index</td><td>Rouse1974</td><td><code>red, nir</code></td><td>\((nir - red)/(nir + red)\)</td></tr><tr><td>NDVIC</td><td>Corrected Normalised Difference Vegetation Index</td><td>Nemani1993</td><td><code>red, nir, swir2</code></td><td>\((nir - red)/(nir + red) * (1 - ((swir2 - swir2ccc)/(swir2coc - swir2ccc)))\)</td></tr><tr><td>NDWI</td><td>Normalised Difference Water Index</td><td>McFeeters1996</td><td><code>green, nir</code></td><td>\((green - nir)/(green + nir)\)</td></tr><tr><td>NDWI2</td><td>Normalised Difference Water Index</td><td>Gao1996</td><td><code>nir, swir2</code></td><td>\((nir - swir2)/(nir + swir2)\)</td></tr><tr><td>NRVI</td><td>Normalised Ratio Vegetation Index</td><td>Baret1991</td><td><code>red, nir</code></td><td>\((red/nir - 1)/(red/nir + 1)\)</td></tr><tr><td>REIP</td><td>Red Edge Inflection Point</td><td>GuyotAndBarnet1988</td><td><code>red, redEdge1, redEdge2, redEdge3</code></td><td>\(0.705 + 0.35 * ((red + redEdge3)/(2 - redEdge1))/(redEdge2 - redEdge1)\)</td></tr><tr><td>RVI</td><td>Ratio Vegetation Index</td><td></td><td><code>red, nir</code></td><td>\(red/nir\)</td></tr><tr><td>SATVI</td><td>Soil Adjusted Total Vegetation Index</td><td>Marsett2006</td><td><code>red, swir2, swir3</code></td><td>\((swir2 - red)/(swir2 + red + L) * (1 + L) - (swir3/2)\)</td></tr><tr><td>SAVI</td><td>Soil Adjusted Vegetation Index</td><td>Huete1988</td><td><code>red, nir</code></td><td>\((nir - red) * (1 + L)/(nir + red + L)\)</td></tr><tr><td>SLAVI</td><td>Specific Leaf Area Vegetation Index</td><td>Lymburger2000</td><td><code>red, nir, swir2</code></td><td>\(nir/(red + swir2)\)</td></tr><tr><td>SR</td><td>Simple Ratio Vegetation Index</td><td>Birth1968</td><td><code>red, nir</code></td><td>\(nir/red\)</td></tr><tr><td>TTVI</td><td>Thiam's Transformed Vegetation Index</td><td>Thiam1997</td><td><code>red, nir</code></td><td>\(sqrt(abs((nir - red)/(nir + red) + 0.5))\)</td></tr><tr><td>TVI</td><td>Transformed Vegetation Index</td><td>Deering1975</td><td><code>red, nir</code></td><td>\(sqrt((nir - red)/(nir + red) + 0.5)\)</td></tr><tr><td>WDVI</td><td>Weighted Difference Vegetation Index</td><td>Richardson1977</td><td><code>red, nir</code></td><td>\(nir - s * red\)</td></tr><tr><td>CUSTOM</td><td>Super custom index</td><td>Mueller2024</td><td><code>red</code></td><td>\(red * 0\)</td></tr><tr><td>CUSTOM2</td><td>Super custom index</td><td>Mueller2024</td><td><code>swir1</code></td><td>\(swir1 - swir1\)</td></tr><tr><td>CUSTOM</td><td>Super custom index</td><td>Mueller2024</td><td><code>red</code></td><td>\(red * 0\)</td></tr><tr><td>CUSTOM2</td><td>Super custom index</td><td>Mueller2024</td><td><code>swir1</code></td><td>\(swir1 - swir1\)</td></tr></table><p>Some indices require additional parameters, such as the slope of the soil line which are specified via a list to the <code>coefs</code> argument.
Although the defaults are sensible values, values like the soil brightnes factor <code>L</code> for SAVI should be adapted depending on the characteristics of the scene.
The coefficients are:</p><table class="table table"><tr><td><strong>Coefficient</strong></td><td><strong>Description</strong></td><td><strong>Affected Indices</strong></td></tr><tr><td><code>s</code></td><td>slope of the soil line</td><td>DVI, WDVI</td></tr><tr><td><code>L_evi, C1, C2, G</code></td><td>various</td><td>EVI</td></tr><tr><td><code>L</code></td><td>soil brightness factor</td><td>SAVI, SATVI</td></tr><tr><td><code>swir2ccc</code></td><td>minimum swir2 value (completely closed forest canopy)</td><td>NDVIC</td></tr><tr><td><code>swir2coc</code></td><td>maximum swir2 value (completely open canopy)</td><td>NDVIC</td></tr></table><p>The wavelength band names are defined following Schowengertd 2007, p10.
The last column shows exemplarily which Landsat 5 TM bands correspond to which wavelength range definition.</p><table class="table table"><tr><td><strong> Band </strong></td><td><strong> Description </strong></td><td><strong> Wavl_min </strong></td><td><strong> Wavl_max </strong></td><td><strong> Landsat5_Band </strong></td><td><strong> Sentinel2_Band </strong></td><td>vis</td></tr><tr><td>visible</td><td>400</td><td>680</td><td>1,2,3</td><td>2,3,4</td><td>red-edge1</td><td>red-edge1</td></tr><tr><td>680</td><td>720</td><td>-</td><td>5</td><td>red-edge2</td><td>red-edge2</td><td>720</td></tr><tr><td>760</td><td>-</td><td>6</td><td>red-edge3</td><td>red-edge3</td><td>760</td><td>800</td></tr><tr><td>-</td><td>7</td><td>nir</td><td>near infra-red</td><td>800</td><td>1100</td><td>4</td></tr><tr><td>8/8a</td><td>swir1</td><td>short-wave infra-red</td><td>1100</td><td>1351</td><td>-</td><td>9,10</td></tr><tr><td>swir2</td><td>short-wave infra-red</td><td>1400</td><td>1800</td><td>5</td><td>11</td><td>swir3</td></tr><tr><td>short-wave infra-red</td><td>2000</td><td>2500</td><td>7</td><td>12</td><td>mir1</td><td>mid-wave infra-red</td></tr><tr><td>3000</td><td>4000</td><td>-</td><td>-</td><td>mir2</td><td>mid-wave infra-red</td><td>45000</td></tr><tr><td>5000</td><td>-</td><td>-</td><td>tir1</td><td>thermal infra-red</td><td>8000</td><td>9500</td></tr><tr><td>-</td><td>-</td><td>tir2</td><td>thermal infra-red</td><td>10000</td><td>140000</td><td>6</td></tr></table></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate NDVI</span></span></span>
<span class="r-in"><span><span class="va">ndvi</span> <span class="op">&lt;-</span> <span class="fu">spectralIndices</span><span class="op">(</span><span class="va">lsat</span>, red <span class="op">=</span> <span class="st">"B3_dn"</span>, nir <span class="op">=</span> <span class="st">"B4_dn"</span>, indices <span class="op">=</span> <span class="st">"NDVI"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ndvi</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class       : SpatRaster </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dimensions  : 310, 287, 1  (nrow, ncol, nlyr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> resolution  : 30, 30  (x, y)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> extent      : 619395, 628005, -419505, -410205  (xmin, xmax, ymin, ymax)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> coord. ref. : +proj=utm +zone=22 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> source(s)   : memory</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> name        :       NDVI </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> min value   : -0.5789474 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> max value   :  0.7629630 </span>
<span class="r-in"><span><span class="fu"><a href="ggR.html">ggR</a></span><span class="op">(</span><span class="va">ndvi</span>, geom_raster <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"white"</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="spectralIndices-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{ </span></span></span>
<span class="r-in"><span><span class="co">## Calculate all possible indices, given the provided bands </span></span></span>
<span class="r-in"><span><span class="co">## Convert DNs to reflectance (required to calculate EVI and EVI2)</span></span></span>
<span class="r-in"><span><span class="va">mtlFile</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external/landsat/LT52240631988227CUB02_MTL.txt"</span>, package<span class="op">=</span><span class="st">"RStoolbox"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lsat_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="radCor.html">radCor</a></span><span class="op">(</span><span class="va">lsat</span>, <span class="va">mtlFile</span>, method <span class="op">=</span> <span class="st">"apref"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 08:28:29 | Bands to convert to reflectance: B1_dn, B2_dn, B3_dn, B4_dn, B5_dn, B7_dn</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 08:28:29 | Thermal bands to convert to brightness temperature: B6_dn</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 08:28:29 | Processing thermal band(s)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 08:28:29 | Processing radiance / reflectance</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">SI</span> <span class="op">&lt;-</span> <span class="fu">spectralIndices</span><span class="op">(</span><span class="va">lsat_ref</span>, red <span class="op">=</span> <span class="st">"B3_tre"</span>, nir <span class="op">=</span> <span class="st">"B4_tre"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">SI</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spectralIndices-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Custom Spectral Index Calculation (beta) (supports only bands right now...)</span></span></span>
<span class="r-in"><span><span class="co"># Get all indices</span></span></span>
<span class="r-in"><span><span class="co"># Supports: Parentheses (), Addition +, Subtraction -, Multiplication *, Division /</span></span></span>
<span class="r-in"><span><span class="va">idxdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"RStoolbox.idxdb"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Customize the RStoolbox index-database and overwrite the option</span></span></span>
<span class="r-in"><span><span class="va">cdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">idxdb</span>, CUSTOM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mueller2024"</span>, <span class="st">"Super custom index"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="kw">function</span><span class="op">(</span><span class="va">blue</span>, <span class="va">red</span><span class="op">)</span> <span class="op">{</span><span class="va">blue</span> <span class="op">+</span> <span class="va">red</span><span class="op">}</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="rsOpts.html">rsOpts</a></span><span class="op">(</span>idxdb <span class="op">=</span> <span class="va">cdb</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the custom index, (also together with the provided ones)</span></span></span>
<span class="r-in"><span><span class="va">custom_ind</span> <span class="op">&lt;-</span> <span class="fu">spectralIndices</span><span class="op">(</span><span class="va">lsat</span>, blue <span class="op">=</span> <span class="fl">1</span>, red <span class="op">=</span> <span class="fl">3</span>, nir <span class="op">=</span> <span class="fl">4</span>, indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NDVI"</span>, <span class="st">"CUSTOM"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benjamin Leutner, Ned Horning, Jakob Schwalb-Willmann, Konstantin Mueller.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

